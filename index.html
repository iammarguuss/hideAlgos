<!DOCTYPE html>
<html lang="en" style="background:#212121">
<head>
    <meta charset="UTF-8">
    <title>Steroid Crypto Demo</title>
    <script src="main.js"></script>
</head>
<body>
    <h1>Steroid Crypto Demo</h1>
    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            // Создаем экземпляр класса SteroidCrypto
            const crypto = new SteroidCrypto();
            console.log(crypto)
    
            // getSkey
            const hash = await crypto.getSkey('Hello, World!');
            console.log('getSkey: ', hash);
    
            //messageEnc
            const message = "Hello, World!";
            const password = "секретныйКлюч";
    
            const encryptedResult = await crypto.messageEnc(message, password, true);
            console.log("Encrypted result:", encryptedResult);
    
            // Расшифровка сообщения, если шифрование было успешным
            if (encryptedResult.s === 1) {
                const decryptedResult = await crypto.messageEnc(encryptedResult.t, password, false);
                console.log("Decrypted result:", decryptedResult);
            }
    
            //getPass
            crypto.getPass(password)
                .then(hash => console.log("Хэш пароля:", hash))
                .catch(error => console.error("Ошибка:", error));
    
           // Генерация пары ключей RSA
           const keyPairResult = await crypto.genPair(); // Можно указать другую битность, например genPair(2048)
            console.log("Key Pair Generation Result:", keyPairResult);
    
            // FirstResponse
            // Предполагается, что публичный ключ уже получен и проверен
            const publicKeyBase64 = keyPairResult.r.publicKey; // Используем сгенерированный ранее публичный ключ
            const firstResponseResult = await crypto.firstResponse(publicKeyBase64);
            console.log("First Response result:", firstResponseResult);

            const encryptedMessageBase64 = firstResponseResult.r.encryptedMessage; // Обращаемся к полю с зашифрованным сообщением
            const privateKeyBase64 = keyPairResult.r.privateKey;
            const result = await crypto.secondResponse(encryptedMessageBase64, privateKeyBase64);
            console.log("Decrypted message:", result);

        });
    </script>
    
</body>
</html>
